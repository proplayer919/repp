import socket
import sys
import scanners.open_ports

# create a function that takes a ip address and a command to execute
def exploit(ip, command):
    ports = []
    # scan for open ports
    ports = scanners.open_ports.scanForOpenPorts(ip)
    # create a socket object
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    for port in ports:
        try:
            # connect to the ip address on port 80
            s.connect((ip, port))
            # send the command to the server
            s.send(command)
            # receive the response from the server
            response = s.recv(1024)
            # print the response
            print(response)

        except socket.gaierror:
            print("Hostname could not be resolved")
            sys.exit()
        except socket.error:
            print("Couldn't connect to server")
        except socket.timeout:
            print("Connection timed out")
    # close the socket
    s.close()